<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        /* 4*3 그리드 설정 */
        .thumb_grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 가로 4개 */
            grid-template-rows: repeat(3, 1fr);    /* 세로 3줄 */
            gap: 15px;
            margin: 40px 0;
        }

        .thumb_item {
            cursor: pointer;
            overflow: hidden;
            aspect-ratio: 1 / 1; /* 정사각형 유지 */
        }

        .thumb_item img {
            width: 100%; height: 100%;
            object-fit: cover;
            transition: 0.3s;
            opacity: 0.6; /* 기본은 흐리게 */
        }

        .thumb_item:hover img, .thumb_item.active img {
            opacity: 1; /* 호버하거나 선택되면 선명하게 */
            transform: scale(1.05);
        }

        /* 페이지네이션 디자인 */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .pagination button, .page_numbers span {
            cursor: pointer;
            padding: 5px 10px;
            font-size: 1.6rem;
            color: #999;
        }

        .page_numbers span.active {
            color: #333;
            font-weight: bold;
            text-decoration: underline;
        }
    </style>

</head>
<body>

    <section id="gallery_section">
    <div class="main_viewer">
        <div class="img_box">
            <img src="images/img1.jpg" id="mainImg" alt="">
        </div>
        <p id="mainCaption">▲ 고층 건설현장 타워크레인 관제</p>
    </div>

    <div class="thumb_grid" id="thumbGrid"></div>

    <div class="pagination">
        <button id="btnFirst">&laquo;</button>
        <button id="btnPrev">&lt;</button>
        <div id="pageNumbers" class="page_numbers"></div>
        <button id="btnNext">&gt;</button>
        <button id="btnLast">&raquo;</button>
    </div>
</section>

<script src="script/jquery-3.7.1.min.js"></script>
<script>
    $(document).ready(function() {
    // 1. 데이터 설정 (이미지 경로와 캡션)
    const imageData = [];
    for(let i=1; i<=60; i++) { // 테스트를 위해 60개의 데이터를 만듭니다.
        imageData.push({
            src: `images/gallery_img${i}.jpg`,
            caption: `▲ 산업 현장 관제 이미지 ${i}`
        });
    }

    const itemsPerPage = 12; // 4*3 = 12개씩 보여줌
    let currentPage = 1;
    const totalPages = Math.ceil(imageData.length / itemsPerPage);

    // 2. 갤러리 렌더링 함수
    function renderGallery(page) {
        const $grid = $('#thumbGrid');
        $grid.empty(); // 기존 썸네일 삭제

        const start = (page - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        const pagedData = imageData.slice(start, end);

        $.each(pagedData, function(index, item) {
            const $thumb = $(`
                <div class="thumb_item">
                    <img src="${item.src}" alt="${item.caption}">
                </div>
            `);

            // 썸네일 클릭 이벤트
            $thumb.on('click', function() {
                $('#mainImg').attr('src', item.src).hide().fadeIn(300); // 페이드 효과
                $('#mainCaption').text(item.caption);
                
                $('.thumb_item').removeClass('active');
                $(this).addClass('active');
            });

            $grid.append($thumb);
        });
        
        renderPagination();
    }

    // 3. 페이지네이션 렌더링 함수
    function renderPagination() {
        const $pageNumbers = $('#pageNumbers');
        $pageNumbers.empty();

        for (let i = 1; i <= totalPages; i++) {
            const $span = $('<span></span>').text(i);
            if (i === currentPage) $span.addClass('active');

            $span.on('click', function() {
                currentPage = i;
                renderGallery(currentPage);
            });

            $pageNumbers.append($span);
        }
    }

    // 4. 이동 버튼 이벤트 전용 제어
    $('#btnFirst').on('click', function() { currentPage = 1; renderGallery(currentPage); });
    $('#btnLast').on('click', function() { currentPage = totalPages; renderGallery(currentPage); });
    $('#btnPrev').on('click', function() { if(currentPage > 1) { currentPage--; renderGallery(currentPage); } });
    $('#btnNext').on('click', function() { if(currentPage < totalPages) { currentPage++; renderGallery(currentPage); } });

    // 초기 실행
    renderGallery(currentPage);
});
</script>

</body>
</html>